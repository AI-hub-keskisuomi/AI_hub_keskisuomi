### Kuvaus simulaatiomallista  
Simulaatiomalli luo aluksi Suomen väestön, joka rakennetaan population ohjelmassa. Väestöjakauma muodostetaan tilastollisten tunnuslukujen pohjalta.  Tilastokeskuksen sivuilla on saatavilla tarkka tieto Suomen väestön vuosittaisista jakaumista. Tiedot ovat saatavilla eri ikäryhmittäin ja sukupuolittain. Suomen väestön populaatio luodaan tietylle esiannetulle alkamisvuodelle, jonka jälkeen simulaatiomallia lähdetään ajamaan vuosittain eteenpäin. Tiedot syntyneistä lapsista päivitetään malliin vuosittain. Tarkastelujakson pituus määritellään etukäteen (oletuksena 3 vuotta). Seurantaa varten jokaiselle henkilölle luodaan yksilöllinen henkilötunniste. 

Nykyisessä Python-mallissa diabetesriski arvioidaan henkilöittäin kansainvälisen FINDRISC-lomakkeen (Finnish Diabeters Risk Calculator) perusteella. Diabetesriskiin vaikuttavia tekijöitä ovat: ikä, painoindeksi, vyötärön ympäryksen mitta (mittojen riskirajat vaihtelevat sukupuolittain), päivittäinen liikunta, päivittäinen vihannesten, hedelmien ja marjojen syönti, korkea verenpaine, korkea verensokerin arvo (myös sairauden tai raskauden aikana) ja suvussa esiintyvä diabetes. Kaikki riskitekijät ovat pisteytetty ja ne lopuksi summataan yhteen. Summatut pisteet toimivat diabeteksen riski-indikaattoreina. Simulaatiomalli käyttää Finterveys-tutkimuksessa koottuja tilastoituja suomalaisen väestön Diabetesriski-pisteytyksien jakaumia. Diabetekseen sairastuminen ja yleinen kuolleisuus on myös tilastoitu. Tilastoihin vaikuttavat potilaan ikä ja sukupuoli. Mikäli osallistuja on diabeetikko, hänen kuolemanriskinsä kasvaa määritellyllä riskikertoimella. Potilaiden kuolemia tarkastellaan simulaatiomallissa kuukausittain.            

Python-mallin kanssa samanaikaisesti luotiin iGrafx-ohjelmistolla versio, jolla mallinnettiin diabetesta FINDRISC-arvon sijaan kliinisellä HbA1c-arvolla. Laskennallisten rajoitteiden vuoksi mallissa tarkasteltiin vain riskiryhmäläisiä eikä muuta populaatiota mallinnettu lainkaan. HbA1c-arvot arvottiin riskiin perustuen ja kliinisen mittarin perusteella jo tautiin sairastuneet jätettiin mallin ulkopuolelle. Taudin etenemistä ja interventioiden vaikutusta siihen on seurattu HbA1c:n muutoksilla. Abstrakti populaatio antaa mahdollisuuden tarkkailla nimenomaan interventioiden yleisiä kustannusvaikutuksia suhteessa toisiinsa ja interventioita ilman olevaan vaihtoehtoon. Koko populaation käyttö taas antaa paremman kuvan kustannusten kehityksestä tietyssä ympäristössä interventioiden kanssa ja ilman niitä.

Nykyisessä mallissa väestöpopulaation luomisen ja diabetesriskien arvioimisen jälkeen mallinnetaan elämäntapainterventioiden vaikutuksia riskitekijöiden muutoksiin. Tämä tapahtuu intervene-ohjelmassa. Mallissa on huomioitu kolmentyyppisiä interventiomuotoja: kasvokkain tapahtuva interventio (f2f intervention), digitaalinen interventio (digi intervention) ja automaattinen interventio (auto intervention). Interventiot toimivat erillisinä funktioina. Tämä mahdollistaa mallin helpon laajennettavuuden uusille eri interventiomuodoille. Interventioiden vaikuttavuus diabeteksen riskitekijöiden alentamisessa vaihtelee. Lisäksi kustannukset vaihtelevat interventiomuotojen välillä. Mallinnettavien interventioiden osallistujat seulotaan eri interventioihin diabetesriskien perusteella. 

Interventioon osallistujaksi valitaan jonkin seuraavista ehdoista täyttävä henkilö: 
1.	FINDRISC-pisteytyksen mukaan korkeassa diabetesriskissä olevat henkilöt, joille on todettu esidiabetes. Esidiabeteksen mahdollisuus korkeassa riskissä olevilla henkilöillä on tilastoitu sukupuolittain. Malli hyödyntää tilastotietoja esidiabeteksen määrittelyssä.
2.	Pisteytyksen mukaan suuressa diabetesriskissä olevat henkilöt, jotka ovat halukkaita aloittamaan intervention. Interventioiden aloittamiset ovat tilastoitu. Mallissa tilastot vaihtelevat sukupuolittain ja tämä huomioidaan kuntoutukseen valinnassa. 
3.	Noin puolet keskisuuressa riskissä olleista henkilöistä, jotka ovat halukkaita aloittamaan intervention. Mallin lukemat perustuvat tilastotietoihin. 

Tämän jälkeen mallinnettavien interventioiden osallistujat ohjataan eri interventioihin FINDRISC-pisteytyksen mukaan. Kasvokkain tapahtuvaan interventioon valitaan osallistujat, joiden diabetesriski on korkea tai jotka sairastavat esidiabetesta. Tämän jälkeen jäljelle jääneistä osallistujista digitaaliseen interventioon ohjataan pisteytyksen mukaan suurimmassa diabetesriskissä olevat. Malli ohjaa osallistujat digitaaliseen interventioon ja automaattisesti toteutettuun interventioon käyttämällä esimääriteltyä prosenttiosuutta. Automaattisesti toteutettuun interventioon ohjataan matalimman diabetesriskin omaavat        

Ylipainon arviointi on keskeisessä osassa FINDRISC-riskipisteytystä. Interventiomuotojen vaikuttavuuden mittareina käytetään normaalijakaumia potilaiden painon muutosten (%) oletetuista jakaumista kussakin eri interventiomuodossa. Jakaumien keskiarvot ja keskihajonnat ovat tarkkaan määritelty siten, että kasvokkain tapahtuva interventio on kaikista tehokkain ja vaikuttaa siten eniten painon perusteella arvioituun riskiin, digitaalinen interventio on seuraavaksi tehokkain ja automaattinen interventio on interventiomuodoista heikoin. Simulaatiomalli ajaa interventioita kuukausittain. Mallissa on myös toteutettu esiasetettu tarkastelujakso, jonka aikana tilastollisesti määritelty osa osallistujista lopettaa intervention (jakson pituus on 3 kk nykyisessä toteutuksessa).

Simulaatiomallissa interventioiden lisäksi diabetekseen sairastuvia osallistujia ohjataan diabeteshoitoryhmään (diabetes care) ja diabeteksen seurantaryhmään (diabetes follow). Hoitoryhmään valitaan mallin tilastojen perusteella diabetesdiagnoosin saavat osallistujat. Diagnoosi suoritetaan vuosittain. Seurantaryhmään puolestaan valitaan ei diagnosoidut osallistujat, jotka eivät ole parhaillaan interventiossa, mutta ovat olleet siinä esimääritellyn tarkastusjakson sisällä. Seurantaryhmässä osallistujien painon perusteella arvioidun diabetesriskin oletetaan edelleen tippuvan. Painon mukaan arvioidun riskin väheneminen perustuu uusiin normaalijakaumamalleihin. Normaalijakaumat on tarkkaan määritelty ja ne valitaan sen perusteella, missä interventiossa osallistuja on joskus ollut. Malli suorittaa tarkastelun esiannetun periodin välein (jakson pituus on 6 kk nykyisessä toteutuksessa). 

Diabeteshoitojen kustannusten tarkkailu on oleellisena osana simulaatiomallia. Kustannusten tarkkailua varten intervene -ohjelmassa on Money -luokka. Luokan muuttujiin tallennetaan kustannukset eri tyypeittäin. Kustannukset tallennetaan kokonaissummittain. Lisäksi kustannuksista pidetään listaa osallistujakohtaisesti. Kustannuksia kertyy muun muassa osallistujien alkuseulonnasta interventioihin, kunkin intervention aloittamisista ja eri interventioiden kuukausikustannuksista.  Lisäksi kasvokkain tapahtuvassa interventiossa ja digitaalisessa interventiossa tarkistetaan esimääritetyin aikaperiodien välein (jakson pituus on 3 kk nykyisessä toteutuksessa) kunkin osallistujan tarve uudelle interventiolle tai interventiota täydentävälle ohjaukselle. Uuden intervention tai lisäohjauksen tarpeista aiheutuu kustannuksia esimääritetyille prosenttiosuuksille osallistujista. Diabeteshoito- ja seurantaryhmään kuuluvien osallistujien interventioiden ylläpidosta seuraa myös kuukausikustannuksia. Seurantaryhmän osallistujista osa tarvitsee interventioon liittyen lisätukea. Kunkin intervention lisätukea tarvitsevien osallistujien prosentuaaliset arvot ovat edeltä määriteltyjä. Interventiosta riippuen kustannukset vaihtelevat lisätukea tarvitsevilla osallistujilla. Vuosittain seurantaryhmän osallistujille suoritetaan lääkärintarkastus, josta syntyy kuluja kullekin osallistujalle.   

Simulaatiomallin tulokset esitetään kuvaajina. Intervene ohjelma sisältää Graphics luokan, joka piirtää käyrän kustannusten vuosittaisesta kasvusta tarkastelujaksolta, kuvan kustannusten jakautumisista eri interventiomuotojen sekä diabeteshoito- ja seurantaryhmän välille, pylväsdiagrammit keskieliniästä miehille ja naisille ja diagrammit rahan keskimääräisestä käytöstä henkilöä kohden miehille ja naisille. Kustannukset tallennetaan lopulta myös lokitiedostoon. Lokitiedostojen numerointi kasvaa aina yhdellä uusien simulaatioajojen välillä.

### Simulation model

Please see the description by using the following link: 
https://www.sciencedirect.com/science/article/pii/S1532046420302057

