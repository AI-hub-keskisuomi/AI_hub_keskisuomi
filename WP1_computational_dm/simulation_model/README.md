### Kuvaus simulaatiomallista  
Simulaatiomalli luo aluksi Suomen väestön, joka rakennetaan population ohjelmassa. Väestöjakauma muodostetaan tilastollisten tunnuslukujen pohjalta.  Tilastokeskuksen sivuilla on saatavilla tarkka tieto Suomen väestön vuosittaisista jakaumista. Tiedot ovat saatavilla eri ikäryhmittäin ja sukupuolittain. Suomen väestön populaatio luodaan tietylle esiannetulle alkamisvuodelle, jonka jälkeen simulaatiomallia lähdetään ajamaan vuosittain eteenpäin. Tiedot syntyneistä lapsista päivitetään malliin vuosittain. Tarkastelujakson pituus määritellään etukäteen (oletuksena 3 vuotta). Seurantaa varten jokaiselle henkilölle luodaan yksilöllinen henkilötunniste. 

Nykyisessä mallissa diabetesriski arvioidaan henkilöittäin kansainvälisen FINDRISC-lomakkeen (Finnish Diabeters Risk Calculator) perusteella. Diabetesriskiin vaikuttavia tekijöitä ovat: ikä, painoindeksi, vyötärön ympäryksen mitta (mittojen riskirajat vaihtelevat sukupuolittain), päivittäinen liikunta, päivittäinen vihannesten, hedelmien ja marjojen syönti, korkea verenpaine, korkea verensokerin arvo (myös sairauden tai raskauden aikana) ja suvussa esiintyvä diabetes. Kaikki riskitekijät ovat pisteytetty ja ne lopuksi summataan yhteen. Summatut pisteet toimivat diabeteksen riski-indikaattoreina. Simulaatiomalli käyttää Finterveystutkimuksissa kasattuja tilastoituja Diabetespisteytyksien jakaumia. Diabeteksen alkaminen ja yleinen kuolema ovat myös tilastoitu. Tilastoihin vaikuttavat potilaan ikä ja sukupuoli. Mikäli potilas on diabeetikko hänen kuoleman riskinsä kasvaa määritellyllä riskikertoimella. Potilaiden kuolemia tarkastellaan simulaatiomallissa kuukausittain.            

Python-mallin kanssa samanaikaisesti luotiin iGrafx-ohjelmistolla versio, jolla mallinnettiin diabetestä FINDRISC-arvon sijaan kliinisellä HbA1c-arvolla. Laskennallisten rajoitteiden vuoksi mallissa tarkasteltiin vain riskiryhmäläisiä eikä muuta populaatiota mallinnettu lainkaan. HbA1c-arvot arvottiin riskiin perustuen ja kliinisen mittarin perusteella jo tautiin sairastuneet jätettiin mallin ulkopuolelle. Taudin etenemistä ja interventioiden vaikutusta siihen on seurattu HbA1c:n muutoksilla. Abstrakti populaatio antaa mahdollisuuden tarkkailla nimenomaan interventioden yleisisiä kustannusvaikutuksia suhteessa toisiinsa ja interventiottomaan vaihtoehtoon. Koko populaation käyttö taas antaa paremman kuvan kustannusten kehityksestä tietyssä ympäristössä interventioiden kanssa ja ilman niitä.

Nykyisessä malissa väestöpopulaation luomisen ja diabetesriskien arvioimisen jälkeen aloitetaan riskipotilaiden mahdollinen kuntouttaminen. Tämä tapahtuu intervene ohjelmassa. Mallissa on huomioitu kolmentyyppisiä eri interventiomuotoja: kasvokkain tapahtuva interventio (f2f intervention), digitaalinen interventio (digi intervention) ja automaattinen interventio (auto intervention). Interventiorutiinit toimivat erillisinä funktioina. Tämä mahdollistaa mallin helpon laajennettavuuden uusille eri interventiomuodoille. Hoitomuotojen tehokkuudet vaihtelevat diabeteksesta kuntoutumiseen eri tavoin. Lisäksi kustannukset vaihtelevat hoitomuotojen välillä. Diabeetikot seulotaan eri interventioihin diabetesriskien perusteella. 

Mahdolliseksi interventioitavaksi potilaaksi valitaan jonkin seuraavista ehdoista täyttävä henkilö: 
1)	Finterveyden pisteytyksen mukaan korkeassa diabetesriskissä olevat potilaat, joille on todettu esidiabetes. Esidiabeteksen mahdollisuus korkeassa riskissä olevilla potilailla on tilastoitu sukupuolittain. Malli hyödyntää tilastotietoja esidiabeteksen määrittelyssä.
2)	Pisteytyksen mukaan suuressa diabetesriskissä olevat potilaat, jotka ovat halukkaita aloittamaan intervention. Interventioiden aloittamiset ovat tilastoitu. Mallissa tilastot vaihtelevat sukupuolittain ja tämä huomioidaan kuntoutukseen valinnassa. 
3)	Noin puolet keskisuuressa riskissä olleista potilaista, jotka ovat halukkaita aloittamaan intervention. Mallin lukemat perustuvat tilastotietoihin. 

Tämän jälkeen kuntoutettavat potilaat järjestellään sairauden vakavuuden mukaan suuruusjärjestykseen. Nykyisessä mallissa järjestely tapahtuu FINDRISC-pisteytyksen mukaan. Kasvokkain tapahtuvaan interventioon valitaan potilaat, jotka ylittävät korkean riskin pisteytyksen tai sairastavat esidiabetesta. Tämän jälkeen jäljelle jääneistä potilaista digitaaliseen interventioon valitaan pisteytyksen mukaan suurimmassa riskissä olevat. Malli jaottelee potilaat digitaaliseen interventioon ja autointerventioon käyttämällä esimääriteltyä prosenttiosuutta. Autointerventioon päätyvät diabetesriskiltään vähiten pisteytetyt potilaat.       

Diabetespotilaiden paino on erittäin keskeisessä osassa FINDRISC-riskipisteytystä. Simulaatiomallissa hoitomuotojen vaikuttavuuden mittareina käytetään normaalijakaumia potilaiden painoriskien oletetuista jakaumista kussakin eri interventiomuodossa. Jakaumien keskiarvot ja keskihajonnat ovat tarkkaan määritelty siten, että kasvokkain tapahtuva interventio on kaikista tehokkain ja vaikuttaa siten eniten painoriskiin, digitaalinen interventio on seuraavaksi tehokkain ja automaattinen interventio on hoitomuodoista heikoin. Simulaatiomalli ajaa interventioita kuukausittain. Mallissa on myös toteutettu esiasetettu tarkastelujakso, jonka aikana tilastollisesti määritelty osa potilaista lopettaa intervention (jakson pituus on 3 kk nykyisessä toteutuksessa. Tämä tullaan muuttamaan 1 kk mittaiseksi).  

Simulaatiomallissa interventioiden lisäksi diabetespotilaita jaotellaan diabeteshoitoryhmään (diabetes care) ja diabetesseurantaryhmään (diabetes follow). Hoitoryhmään valitaan mallin tilastojen perusteella diabetekseen diagnosoidut potilaat. Diagnoosi suoritetaan vuosittain. Seurantaryhmään puolestaan valitaan ei diagnosoidut potilaat, jotka eivät ole parhaillaan interventiossa, mutta ovat olleet siinä esimääritellyn tarkastusjakson sisällä. Seurantaryhmässä potilaiden painoriskien oletetaan edelleen tippuvan. Painoriskien pudotukset perustuvat uusiin normaalijakaumamalleihin. Normaalijakaumat on tarkkaan määritelty ja ne valitaan sen perusteella, missä interventiossa potilas on joskus ollut. Malli suorittaa tarkastelun esiannetun periodin välein (jakson pituus on 6 kk nykyisessä toteutuksessa). 

Diabeteshoitojen kustannusten tarkkailu on oleellisena osana simulaatiomallia. Kustannusten tarkkailua varten intervene ohjelmassa on Money luokka. Luokan muuttujiin tallennetaan kustannukset eri tyypeittäin. Kustannukset tallennetaan kokonaissummittain. Lisäksi kustannuksista pidetään listaa potilaittain. Kustannuksia kertyy muun muassa potilaiden alkuseulannasta interventioihin, kunkin intervention aloittamisista ja eri interventioiden kuukausikustannuksista.  Lisäksi kasvokkain tapahtuvassa interventiossa ja digitaalisessa interventiossa tarkistetaan esimääritetyin aikaperiodien välein (jakson pituus on 3 kk nykyisessä toteutuksessa) kunkin potilaan tarve interventioon uudelleen ohjaukseen tai intervention lopun ohjaukseen liittyen. Uudelleenohjauksen tai lopun ohjauksen tarpeista aiheutuu kustannuksia esimääritetyille prosenttiosuuksille potilaista. Diabeteshoito- ja seurantaryhmään kuuluvat potilaat tuottavat ylläpitoon liittyviä kuukausikustannuksia. Seurantaryhmän potilaista osa tarvitsee hoitoon liittyen lisätukea. Kunkin intervention lisätukea tarvitsevien potilaiden prosentuaaliset arvot ovat edeltä määriteltyjä. Interventiosta riippuen kustannukset vaihtelevat tukea tarvitsevilla potilailla. Vuosittain seurantaryhmän potilaille suoritetaan lääkärintarkastus, josta syntyy kuluja kullekin potilaalle.   

Simulaatiomallin tulokset esitetään kuvaajina. Intervene ohjelma sisältää Graphics luokan, joka piirtää käyrän kustannusten vuosittaisesta kasvusta tarkastelujaksolta, kuvan kustannusten jakautumisista eri interventiomuotojen sekä diabeteshoito- ja seurantaryhmän välille, pylväsdiagrammit keskielini’istä miehille ja naisille ja diagrammit rahan keskimääräisestä käytöstä henkilöä kohden miehille ja naisille. Kustannukset tallennetaan lopulta myös lokitiedostoon. Lokitiedostojen numerointi kasvaa aina yhdellä uusien simulaatioajojen välillä.

### Simulation model

Please see the description by using the following link: 
https://www.sciencedirect.com/science/article/pii/S1532046420302057?via%3Dihub
"Developing and testing a discrete event simulation model to evaluate budget impacts of diabetes prevention programs"

